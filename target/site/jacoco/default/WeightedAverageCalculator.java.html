<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>WeightedAverageCalculator.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Weighted Average Calculator</a> &gt; <a href="index.source.html" class="el_package">default</a> &gt; <span class="el_source">WeightedAverageCalculator.java</span></div><h1>WeightedAverageCalculator.java</h1><pre class="source lang-java linenums">import java.util.List;
import java.util.ArrayList;

/**
 * A calculator for computing weighted averages of lists using corresponding weights.
 * This class provides methods to calculate weighted averages with comprehensive input validation.
 */
<span class="fc" id="L8">public class WeightedAverageCalculator {</span>

    /**
     * Calculates the weighted average of a list of values using corresponding weights.
     *
     * @param values the list of values to average
     * @param weights the list of weights corresponding to each value
     * @return the weighted average
     * @throws IllegalArgumentException if lists are null, empty, different sizes, 
     *         contain invalid values, or if total weight is zero
     */
    public double calculateWeightedAverage(List&lt;Double&gt; values, List&lt;Double&gt; weights) {
        // Input validation
<span class="fc" id="L21">        validateInput(values, weights);</span>
        
        // Handle single element case efficiently
<span class="fc bfc" id="L24" title="All 2 branches covered.">        if (values.size() == 1) {</span>
<span class="fc" id="L25">            return values.get(0);</span>
        }
        
<span class="fc" id="L28">        double sumProduct = 0.0;</span>
<span class="fc" id="L29">        double sumWeights = 0.0;</span>
        
<span class="fc bfc" id="L31" title="All 2 branches covered.">        for (int i = 0; i &lt; values.size(); i++) {</span>
<span class="fc" id="L32">            double value = values.get(i);</span>
<span class="fc" id="L33">            double weight = weights.get(i);</span>
            
<span class="fc" id="L35">            sumProduct += value * weight;</span>
<span class="fc" id="L36">            sumWeights += weight;</span>
        }
        
        // This should not happen due to validation, but added for safety
<span class="pc bpc" id="L40" title="1 of 2 branches missed.">        if (sumWeights == 0.0) {</span>
<span class="nc" id="L41">            throw new IllegalArgumentException(&quot;Total weight cannot be zero&quot;);</span>
        }
        
<span class="fc" id="L44">        return sumProduct / sumWeights;</span>
    }
    
    private void validateInput(List&lt;Double&gt; values, List&lt;Double&gt; weights) {
        // Check for null lists
<span class="fc bfc" id="L49" title="All 4 branches covered.">        if (values == null || weights == null) {</span>
<span class="fc" id="L50">            throw new IllegalArgumentException(&quot;Values and weights lists cannot be null&quot;);</span>
        }
        
        // Check for empty lists
<span class="pc bpc" id="L54" title="1 of 4 branches missed.">        if (values.isEmpty() || weights.isEmpty()) {</span>
<span class="fc" id="L55">            throw new IllegalArgumentException(&quot;Values and weights lists cannot be empty&quot;);</span>
        }
        
        // Check for size mismatch
<span class="fc bfc" id="L59" title="All 2 branches covered.">        if (values.size() != weights.size()) {</span>
<span class="fc" id="L60">            throw new IllegalArgumentException(</span>
<span class="fc" id="L61">                String.format(&quot;Values and weights lists must have same size. Got %d values and %d weights&quot;, </span>
<span class="fc" id="L62">                    values.size(), weights.size()));</span>
        }
        
        // Check for invalid values and weights
<span class="fc bfc" id="L66" title="All 2 branches covered.">        for (int i = 0; i &lt; values.size(); i++) {</span>
<span class="fc" id="L67">            Double value = values.get(i);</span>
<span class="fc" id="L68">            Double weight = weights.get(i);</span>
            
            // Check for null values
<span class="pc bpc" id="L71" title="2 of 4 branches missed.">            if (value == null || weight == null) {</span>
<span class="nc" id="L72">                throw new IllegalArgumentException(&quot;Values and weights cannot contain null elements&quot;);</span>
            }
            
            // Check for special double values
<span class="fc bfc" id="L76" title="All 4 branches covered.">            if (Double.isNaN(value) || Double.isInfinite(value)) {</span>
<span class="fc" id="L77">                throw new IllegalArgumentException(&quot;Values cannot be NaN or infinite&quot;);</span>
            }
            
<span class="pc bpc" id="L80" title="2 of 4 branches missed.">            if (Double.isNaN(weight) || Double.isInfinite(weight)) {</span>
<span class="nc" id="L81">                throw new IllegalArgumentException(&quot;Weights cannot be NaN or infinite&quot;);</span>
            }
            
            // Check for negative weights
<span class="fc bfc" id="L85" title="All 2 branches covered.">            if (weight &lt; 0) {</span>
<span class="fc" id="L86">                throw new IllegalArgumentException(&quot;Weights cannot be negative&quot;);</span>
            }
        }
        
        // Check if all weights are zero
<span class="fc bfc" id="L91" title="All 2 branches covered.">        boolean allWeightsZero = weights.stream().allMatch(weight -&gt; weight == 0.0);</span>
<span class="fc bfc" id="L92" title="All 2 branches covered.">        if (allWeightsZero) {</span>
<span class="fc" id="L93">            throw new IllegalArgumentException(&quot;At least one weight must be non-zero&quot;);</span>
        }
<span class="fc" id="L95">    }</span>
    
    /**
     * Convenience method for calculating weighted average of integer values.
     *
     * @param values the list of integer values to average
     * @param weights the list of weights corresponding to each value
     * @return the weighted average
     */
    public double calculateWeightedAverageWithIntValues(List&lt;Integer&gt; values, List&lt;Double&gt; weights) {
<span class="fc" id="L105">        List&lt;Double&gt; doubleValues = values.stream()</span>
<span class="fc" id="L106">            .map(Integer::doubleValue)</span>
<span class="fc" id="L107">            .toList();</span>
<span class="fc" id="L108">        return calculateWeightedAverage(doubleValues, weights);</span>
    }
    
    /**
     * Convenience method for calculating weighted average with integer weights.
     *
     * @param values the list of values to average
     * @param weights the list of integer weights corresponding to each value
     * @return the weighted average
     */
    public double calculateWeightedAverageWithIntWeights(List&lt;Double&gt; values, List&lt;Integer&gt; weights) {
<span class="fc" id="L119">        List&lt;Double&gt; doubleWeights = weights.stream()</span>
<span class="fc" id="L120">            .map(Integer::doubleValue)</span>
<span class="fc" id="L121">            .toList();</span>
<span class="fc" id="L122">        return calculateWeightedAverage(values, doubleWeights);</span>
    }
    
    /**
     * Convenience method for calculating weighted average with both integer values and weights.
     *
     * @param values the list of integer values to average
     * @param weights the list of integer weights corresponding to each value
     * @return the weighted average
     */
    public double calculateWeightedAverageWithInts(List&lt;Integer&gt; values, List&lt;Integer&gt; weights) {
<span class="fc" id="L133">        List&lt;Double&gt; doubleValues = values.stream()</span>
<span class="fc" id="L134">            .map(Integer::doubleValue)</span>
<span class="fc" id="L135">            .toList();</span>
<span class="fc" id="L136">        List&lt;Double&gt; doubleWeights = weights.stream()</span>
<span class="fc" id="L137">            .map(Integer::doubleValue)</span>
<span class="fc" id="L138">            .toList();</span>
<span class="fc" id="L139">        return calculateWeightedAverage(doubleValues, doubleWeights);</span>
    }
    
    /**
     * Main method for demonstration and testing from command line.
     *
     * @param args command line arguments (not used)
     */
    public static void main(String[] args) {
<span class="nc" id="L148">        WeightedAverageCalculator calculator = new WeightedAverageCalculator();</span>
        
        // Example usage
<span class="nc" id="L151">        List&lt;Double&gt; values = List.of(10.0, 20.0, 30.0);</span>
<span class="nc" id="L152">        List&lt;Double&gt; weights = List.of(1.0, 2.0, 3.0);</span>
        
        try {
<span class="nc" id="L155">            double result = calculator.calculateWeightedAverage(values, weights);</span>
<span class="nc" id="L156">            System.out.printf(&quot;Weighted average of %s with weights %s is: %.2f%n&quot;, </span>
<span class="nc" id="L157">                values, weights, result);</span>
<span class="nc" id="L158">        } catch (IllegalArgumentException e) {</span>
<span class="nc" id="L159">            System.err.println(&quot;Error calculating weighted average: &quot; + e.getMessage());</span>
<span class="nc" id="L160">        }</span>
        
        // Demonstrate with integers
<span class="nc" id="L163">        List&lt;Integer&gt; intValues = List.of(5, 10, 15);</span>
<span class="nc" id="L164">        List&lt;Integer&gt; intWeights = List.of(1, 3, 1);</span>
        
        try {
<span class="nc" id="L167">            double intResult = calculator.calculateWeightedAverageWithInts(intValues, intWeights);</span>
<span class="nc" id="L168">            System.out.printf(&quot;Weighted average of %s with weights %s is: %.2f%n&quot;, </span>
<span class="nc" id="L169">                intValues, intWeights, intResult);</span>
<span class="nc" id="L170">        } catch (IllegalArgumentException e) {</span>
<span class="nc" id="L171">            System.err.println(&quot;Error calculating weighted average: &quot; + e.getMessage());</span>
<span class="nc" id="L172">        }</span>
<span class="nc" id="L173">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>